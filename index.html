<!doctype html>


emojiEl.textContent = type === 'spend' ? 'ðŸ¤¯' : 'ðŸ˜„';


// update chart
myChart.data.datasets[0].data = [yearly, future];
myChart.options.scales.y.max = Math.max(future, yearly) * 1.15;
myChart.update();
}


// initial run
updateAll();


updateBtn.addEventListener('click', () => {
updateAll();
// push URL state for sharing
const params = new URLSearchParams({
title: titleInput.value,
amount: amountInput.value,
freq: freqInput.value,
type: typeInput.value,
rate: rateInput.value,
years: yearsInput.value
});
history.replaceState({}, '', `${location.pathname}?${params.toString()}`);
});


// copy link
shareBtn.addEventListener('click', async () => {
const url = location.origin + location.pathname + '?' + new URLSearchParams({
title: titleInput.value,
amount: amountInput.value,
freq: freqInput.value,
type: typeInput.value,
rate: rateInput.value,
years: yearsInput.value
}).toString();
try{
await navigator.clipboard.writeText(url);
shareBtn.textContent = 'Link copied!';
setTimeout(()=> shareBtn.textContent = 'Copy share link', 1500);
}catch(e){
prompt('Copy this link:', url);
}
});


// download chart as PNG
downloadBtn.addEventListener('click', () => {
const a = document.createElement('a');
a.href = document.getElementById('myChart').toDataURL('image/png', 1);
a.download = `${(titleInput.value||'expense').replace(/\s+/g,'_')}_chart.png`;
a.click();
});


// allow pressing Enter in inputs to update quickly
[titleInput, amountInput, rateInput, yearsInput].forEach(el => {
el.addEventListener('keydown', (e) => { if(e.key === 'Enter') updateBtn.click(); });
});


// initialize with URL params without needing user to click
window.addEventListener('load', () => {
updateAll();
});


// tiny accessibility focus outline
document.addEventListener('keydown', (e) => {
if(e.key === 'Tab') document.body.classList.add('show-focus');
});
</script>
</body>
</html>
